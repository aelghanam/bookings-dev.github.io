<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <link rel="icon" type="image/jpg" href="favicon.png" />
  <title>CCC Optimo</title>
</head>

<body>
  BLAHH

  <script>
    __gigyaConf = {
      sessionExpiration: 60 * 60 * 24 * 3,
      onGigyaServiceReady: function () {
        gigya.accounts.addEventHandlers({
          onLogin: function (r) {
            // User is logged in
            console.log("onLogin fired from HTML JS", r);
            document.getElementById("RAASLogin").style.display = "none";
            document.getElementById("welcomeMessageAnon").style.display = "none";
            document.getElementById("welcomeMessage").style.display = "block";
            document.getElementById("RAASLogout").style.display = "block";

            // Get the username (replace with your actual method to retrieve the username)
            const username = r.profile.firstName + " " + r.profile.lastName; // Replace with the actual username

            // Update the welcome message with the username
            document.getElementById("username").textContent = username;
          },
          onLogout: function (r) {
            // User is logged out
            console.log("onLogout fired from HTML JS", r);
            document.getElementById("RAASLogin").style.display = "block";
            document.getElementById("welcomeMessageAnon").style.display = "block";
            document.getElementById("welcomeMessage").style.display = "none";
            document.getElementById("RAASLogout").style.display = "none";
          },
        });
        gigya.accounts.session.verify({
          callback: function (response) {
            console.log("Session.Verify response:", response)
            if (response.errorCode == 0) {
              // gigya.accounts.showScreenSet({screenSet:'Default-ProfileUpdate',containerID: 'RAASLogin'});
              console.log("sessionVerified fired from HTML JS");
            } else {
              console.log("sessionNotVerified fired from HTML JS");
            }
          },
        });
        gigya.hasSession().then(function (sessionExist) {
          console.log("fired from HTML JS - Logged In", sessionExist);
          gigya.accounts.getAccountInfo({
            callback: function (params) {
              // User is logged in
              console.log("onLogin fired from HTML JS", r);
              document.getElementById("RAASLogin").style.display = "none";
              document.getElementById("welcomeMessageAnon").style.display = "none";
              document.getElementById("welcomeMessage").style.display = "block";
              document.getElementById("RAASLogout").style.display = "block";

              // Get the username (replace with your actual method to retrieve the username)
              const username = r.profile.firstName + " " + r.profile.lastName; // Replace with the actual username

              // Update the welcome message with the username
              document.getElementById("username").textContent = username;
            }
          })
        });
      },
    };
  </script>
  <script>
    function login() {
      gigya.sso.login({
        authFlow: "redirect",
        redirectURL: window.location.href,
        context: {
          myCustomLang: "en",
          myCustomSessionExpiration: 60 * 60 * 24 * 3,
          useChildContext: true,
          custom: "sss",
        },
      });
    }

    function logout() {
      gigya.acounts.logout({
        callback: function (r) {
          console.log("User logged out", r)

          // Get the username (replace with your actual method to retrieve the username)
          //const username = r.profile.firstName+" "+r.profile.lastName; // Replace with the actual username

          // Update the welcome message with the username
          //document.getElementById("username").textContent = username;
        }
      })
    }
  </script>
  <script src="https://cdns.gigya.com/js/gigya.js?apikey=4_rRdNpwgkoWC395b6eGf3CA"></script>
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

  <!-- The welcome message (initially hidden) -->
  <div id="welcomeMessageAnon" style="display: block;">
    Welcome , please login!
  </div>
  <!-- The login button -->
  <div id="RAASLogin" style="display: block;">
    <input id="loginButton" type="submit" value="Login" onclick="login()" />
  </div>

  <!-- The welcome message (initially hidden) -->
  <div id="welcomeMessage" style="display: none;">
    Welcome back, <span id="username"></span>!
  </div>
  <!-- The login button -->
  <div id="RAASLogout" style="display: none;">
    <input id="loginButton" type="submit" value="Logout" onclick="logout()" />
  </div>

  <script></script>
</body>

</html>